---
title: ECSæ¶æ„(Entity-Component-System)
publishDate: 2025-08-17
tags: [ğŸ’»IT, ğŸ¤–AIå›ç­”]
---

import { Aside } from 'astro-pure/user'

<Aside title="AI Note">ğŸ¤–æœ¬æ–‡ä¸º DeepSeek å›ç­”ã€‚</Aside>

ECS (å®ä½“-ç»„ä»¶-ç³»ç»Ÿ) æ˜¯ä¸€ç§å¸¸ç”¨äºæ¸¸æˆå¼€å‘å’Œé«˜æ€§èƒ½åº”ç”¨çš„è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œå®ƒå°†æ•°æ®ä¸è¡Œä¸ºåˆ†ç¦»ï¼Œå¼ºè°ƒç»„åˆä¼˜äºç»§æ‰¿çš„åŸåˆ™ã€‚

## æ ¸å¿ƒæ¦‚å¿µ

### 1. å®ä½“ (Entity)
- æ¸¸æˆ/åº”ç”¨ä¸­çš„åŸºæœ¬å¯¹è±¡æˆ–äº‹ç‰©
- åªæ˜¯ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ç¬¦(ID)ï¼Œä¸åŒ…å«æ•°æ®æˆ–è¡Œä¸º
- ä»£è¡¨å¦‚ç©å®¶ã€æ•Œäººã€é“å…·ç­‰æ¸¸æˆå¯¹è±¡

### 2. ç»„ä»¶ (Component)
- çº¯æ•°æ®å®¹å™¨ï¼Œæ²¡æœ‰è¡Œä¸º
- ä»£è¡¨å®ä½“çš„æŸä¸€æ–¹é¢ç‰¹æ€§(å¦‚ä½ç½®ã€æ¸²æŸ“ã€å¥åº·å€¼ç­‰)
- ä¾‹å¦‚: `PositionComponent`, `HealthComponent`, `SpriteComponent`

### 3. ç³»ç»Ÿ (System)
- åŒ…å«é€»è¾‘å’Œè¡Œä¸ºçš„å¤„ç†å™¨
- æ“ä½œå…·æœ‰ç‰¹å®šç»„ä»¶ç»„åˆçš„å®ä½“
- ä¾‹å¦‚: `MovementSystem` å¤„ç†æ‰€æœ‰å…·æœ‰ `PositionComponent` å’Œ `VelocityComponent` çš„å®ä½“

## ä¼˜åŠ¿

1. **çµæ´»æ€§**ï¼šé€šè¿‡ç»„åˆä¸åŒç»„ä»¶åŠ¨æ€åˆ›å»ºå®ä½“
2. **æ€§èƒ½**ï¼šæ•°æ®å±€éƒ¨æ€§ä¼˜åŒ–ï¼Œé€‚åˆç¼“å­˜
3. **å¯ç»´æŠ¤æ€§**ï¼šå…³æ³¨ç‚¹åˆ†ç¦»ï¼Œæ˜“äºæ‰©å±•
4. **å¹¶è¡Œå¤„ç†**ï¼šç³»ç»Ÿä¹‹é—´å¤©ç„¶è§£è€¦ï¼Œæ˜“äºå¹¶è¡ŒåŒ–

## å…¸å‹å®ç°ç¤ºä¾‹

```cpp
// ç»„ä»¶ç¤ºä¾‹
struct Position {
    float x, y;
};

struct Velocity {
    float dx, dy;
};

// ç³»ç»Ÿç¤ºä¾‹
class MovementSystem {
public:
    void update(entt::registry& registry, float deltaTime) {
        auto view = registry.view<Position, Velocity>();
        for (auto entity : view) {
            auto& pos = view.get<Position>(entity);
            auto& vel = view.get<Velocity>(entity);
            pos.x += vel.dx * deltaTime;
            pos.y += vel.dy * deltaTime;
        }
    }
};
```

## å¸¸è§ECSæ¡†æ¶

1. **EnTT** (C++)
2. **Flecs** (C/C++)
3. **Bevy ECS** (Rust)
4. **Entitas** (C#)
5. **Specs** (Rust)

ECSæ¶æ„ç‰¹åˆ«é€‚åˆéœ€è¦é«˜æ€§èƒ½å’Œçµæ´»æ€§çš„åœºæ™¯ï¼Œå¦‚æ¸¸æˆå¼€å‘ã€æ¨¡æ‹Ÿç³»ç»Ÿå’Œæ•°æ®å¯†é›†å‹åº”ç”¨ã€‚
